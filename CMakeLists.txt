CMAKE_MINIMUM_REQUIRED(VERSION 2.8)
PROJECT(FoolGo)
SET(CMAKE_CXX_COMPILER c++)
ADD_DEFINITIONS(-std=c++0x)
IF(APPLE)
    ADD_DEFINITIONS(-stdlib=libc++)
ENDIF()
ADD_DEFINITIONS(-O3)
SET(CMAKE_CXX_FLAGS "-Wno-unused-result")
SET(CMAKE_EXE_LINKER_FLAGS "-g")

SET(GTEST_ROOT /usr/share/gtest-1.7.0)
SET(SRC src)
SET(TEST test)

INCLUDE_DIRECTORIES(${SRC})
AUX_SOURCE_DIRECTORY(${SRC} SRCS)
ADD_EXECUTABLE(foolgo ${SRCS})
IF (APPLE)
    TARGET_LINK_LIBRARIES(foolgo c++)
ENDIF()

IF (test)
    ENABLE_TESTING()

    INCLUDE_DIRECTORIES(test ${GTEST_ROOT} ${GTEST_ROOT}/include)

    SET(GTEST_MAIN ${GTEST_ROOT}/src/gtest_main.cc)
    SET(GTEST_LIBS ${GTEST_ROOT}/libgtest.a ${GTEST_ROOT}/libgtest_main.a pthread c++)

    SET(TESTS ${SRCS} ${GTEST_MAIN})
    AUX_SOURCE_DIRECTORY(${TEST} TESTS)
    LIST(REMOVE_ITEM TESTS ${SRC}/foolishgo.cc)
    ADD_EXECUTABLE(tests ${TESTS})
    TARGET_LINK_LIBRARIES(tests ${GTEST_LIBS})

    ADD_TEST(NAME BoardTest COMMAND tests)
    ADD_TEST(NAME BoardInGmTest COMMAND tests)
ENDIF()
